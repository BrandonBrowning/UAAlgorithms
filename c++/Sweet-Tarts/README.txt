Notes:
 • This solution requires c++11. 
 • There is an error in visual studios 2010 where types of map<tuple<...>, T> will cause a compilation error.
